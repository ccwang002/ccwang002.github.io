<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">
<meta name="author" content="Liang-Bo Wang" />
<meta name="description" content="Fira Code has been my choice of the programming font for a while. It‚Äôs also the default monospace font of my blog. I like its ligatures such as >= and connected lines ====== ------. It evens renders the progress bar nicely Ó∏ÉÓ∏ÑÓ∏ÑÓ∏ÑÓ∏ÅÓ∏ÅÓ∏Ç. It makes my plain text documents look neat. That said, I ‚Ä¶" />
<meta name="keywords" content="en, font">
	<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.95em%22 font-size=%2295%22>üìñ</text></svg>">
	<title>Fix Fira Code font ligatures and features</title>

	<!-- og -->
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Liang-Bo Wang's Blog"/>
<meta property="og:title" content="Fix Fira Code font ligatures and features"/>
<meta property="og:description" content="Fira Code has been my choice of the programming font for a while. It‚Äôs also the default monospace font of my blog. I like its ligatures such as >= and connected lines ====== ------. It evens renders the progress bar nicely Ó∏ÉÓ∏ÑÓ∏ÑÓ∏ÑÓ∏ÅÓ∏ÅÓ∏Ç. It makes my plain text documents look neat. That said, I ‚Ä¶"/>
<meta property="og:locale" content=""/>
<meta property="og:url" content="https://blog.liang2.tw/posts/2022/03/fix-fira-code-font-features/"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2022-03-01 00:00:00-06:00"/>
<meta property="article:modified_time" content="2022-05-13 12:50:28.437807-05:00"/>
<meta property="article:author" content="https://blog.liang2.tw/author/liang-bo-wang.html">
<meta property="article:section" content="Coding"/>
<meta property="article:tag" content="en"/>
<meta property="article:tag" content="font"/>
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@ccwang002">
<meta name="twitter:title" content="Fix Fira Code font ligatures and features">
<meta name="twitter:description" content="Fira Code has been my choice of the programming font for a while. It‚Äôs also the default monospace font of my blog. I like its ligatures such as >= and connected lines ====== ------. It evens renders the progress bar nicely Ó∏ÉÓ∏ÑÓ∏ÑÓ∏ÑÓ∏ÅÓ∏ÅÓ∏Ç. It makes my plain text documents look neat. That said, I ‚Ä¶">

	<!-- Feeds -->
	<link href="https://blog.liang2.tw/feeds/all.atom.xml"
		type="application/atom+xml" rel="alternate" title="Liang-Bo Wang's Blog" />

	<link rel="stylesheet" type="text/css" href="https://blog.liang2.tw/theme/styles/styles.css" />
	<link rel="stylesheet" type="text/css" href="https://blog.liang2.tw/theme/katex-0.15.3/katex.min.css">
</head>

<body class="post-template">
	<header class="site-head">
		<h1 class="blog-title"><a href="https://blog.liang2.tw">Liang-Bo Wang's Blog</a></h1>
		<h2 class="blog-description">
			<a href="https://blog.liang2.tw/about-me/">About</a> |
			<a href="https://blog.liang2.tw/talks/">Talks</a> |
			<a href="https://blog.liang2.tw/archives.html">Archives</a> |
			<svg class="theme-toggle" width="24" height="24" viewBox="0 0 24 24" aria-label="auto" aria-live="polite">
				<path class="moon" fill="currentColor" d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z" />
				<path class="sun" fill="currentColor" d="M3.55 19.09L4.96 20.5L6.76 18.71L5.34 17.29M12 6C8.69 6 6 8.69 6 12S8.69 18 12 18 18 15.31 18 12C18 8.68 15.31 6 12 6M20 13H23V11H20M17.24 18.71L19.04 20.5L20.45 19.09L18.66 17.29M20.45 5L19.04 3.6L17.24 5.39L18.66 6.81M13 1H11V4H13M6.76 5.39L4.96 3.6L3.55 5L5.34 6.81L6.76 5.39M1 13H4V11H1M13 20H11V23H13"></path>
			</svg>
		</h2>
	</header>
	<main id="content" class="content" role="main">
<article class="post">
    <span class="post-meta">
        <time datetime="2022-03-01">Mar 01, 2022</time>
        in <a href="https://blog.liang2.tw/category/coding/">Coding</a>
    </span>
    <h1 class="post-title">
        <a href="https://blog.liang2.tw/posts/2022/03/fix-fira-code-font-features/" rel="bookmark" title="Permalink to Fix Fira Code font ligatures and features">Fix Fira Code font ligatures and features</a>
    </h1>
    <span class="post-meta">
                <a href="https://blog.liang2.tw/tag/en/">en</a>
                <a href="https://blog.liang2.tw/tag/font/">font</a>
    </span>
    <section class="post-content"><p><a href="https://github.com/tonsky/FiraCode">Fira Code</a> has been my choice of the programming font for a while. It&rsquo;s also the default monospace font of my blog.
I like its ligatures such as <code>&gt;=</code> and connected lines <code>======</code> <code>------</code>.
It evens renders the progress bar nicely <code>Ó∏ÉÓ∏ÑÓ∏ÑÓ∏ÑÓ∏ÅÓ∏ÅÓ∏Ç</code>.
It makes my plain text documents look neat.</p>
<p>That said, I don&rsquo;t like the default ampersands <code>&amp;</code> and the at signs <code>@</code>.
I find them harder to read than their traditional looks.
To change their looks, we can enable the alternative ligatures and features of the font using <a href="https://ilovetypography.com/OpenType/opentype-features.html">different OpenType features</a> (see also <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Fonts/OpenType_fonts_guide">the guide on MDN</a>).
In this case, <code>ss05</code> and <code>ss08</code> enable the traditional looks of ampersands and at signs, respectively.
Most modern editors and word processors are able to configure the feature sets in use.</p>
<figure>
    <img src="https://blog.liang2.tw/posts/2022/03/fix-fira-code-font-features/pics/fira_code_comparison.png">
    <figcaption>Comparison of the Fira Code rendering with and without the features fixed (ss01, ss03, ss05, and ss08).</figcaption>
</figure>

<p>Unfortunately, I encounter programs that are unable to configure the font features.
While tools like <a href="https://twardoch.github.io/fonttools-opentype-feature-freezer/">pyftfeatfreeze (OpenType Feature Freezer)</a> are able to swap specific glyphs by directly editing the font file, ligatures of those glyphs may fail.
For example, <code>ss08</code> feature (e.g., <code>==</code>, <code>!=</code>, and <code>===</code>) won&rsquo;t be permanently enabled using this approach.</p>
<h2 id="permanently-fix-the-font-features-using-the-official-build-script-update-in-2022-03">Permanently fix the font features using the official build script (update in 2022-03)</h2>
<p>Thanks to the <a href="https://github.com/tonsky/FiraCode/pull/1387">pull request by <code>@Daxtorim</code></a> a few days after this post was published, we now are able to permanently fix the font features using the official build script:</p>
<div class="highlight"><pre><span></span><code class="language-bash">docker run -it --rm <span class="se">\</span>
    -v <span class="nv">$PWD</span>:/opt/FiraCode <span class="se">\</span>
    tonsky/firacode:latest <span class="se">\</span>
    ./FiraCode/script/build.sh <span class="se">\</span>
    -f <span class="s2">&quot;ss01,ss03,ss05,ss08&quot;</span> <span class="se">\</span>
    -n <span class="s2">&quot;Fira Code ss01 ss03 ss05 ss08&quot;</span>

<span class="c1"># Rename the generated TTFs</span>
parallel <span class="s1">&#39;mv {} {.}.ss1358_enabled.ttf&#39;</span> ::: distr/ttf/<span class="s1">&#39;Fira Code ss01 ss03 ss05 ss08&#39;</span>/*.ttf
</code></pre></div>

<p>And that&rsquo;s it!
This is the easiest solution and it works straight out of the box.
Praise the open source community :)
I still kept the original instructions below to manually create the patches since that&rsquo;s what happens behind the scene.</p>
<h2 id="permanently-fix-the-font-features">Permanently fix the font features</h2>
<p>By changing the source code of the font generation, it should be possible to permanently fix any font features (aka patching).
As mentioned by <a href="https://github.com/tonsky/FiraCode/issues/869#issuecomment-548006778">the original author (<code>@tonsky</code>)</a>:</p>
<blockquote>
<p>There is probably a simpler approach to patching the font, just concat whatever code there is in ssXX and add it to the end of calt feature.
That should work on the current version of the font, but you‚Äôll need to do your own research on which scripts to use for that</p>
</blockquote>
<p>And that&rsquo;s exactly my patch for <code>FiraCode.glyphs</code>.
Copy all the content of the features (say, ss01, ss03, ss05, and ss08) to <code>calt</code>. So the original code:</p>
<div class="highlight"><pre><span></span><code class="language-text"># FiraCode.glyphs
{
code = &quot;lookup less_bar_greater ...
... underscores;\012&quot;;
name = calt;
},
</code></pre></div>

<p>becomes:</p>
<div class="highlight"><pre><span></span><code class="language-text">{
code = &quot;lookup less_bar_greater ...
... underscores;\012
# ss01\012  sub r by r.ss01;
# ss03\012  sub ampersand by ampersand.ss03;...
# ss05\012  sub at by at.ss05;\012sub asciitilde.spacer&#39;; ...
# ss08\012  sub equal_equal.liga by equal_equal.ss08;...
&quot;;
name = calt;
},
</code></pre></div>

<p>Then build the font from the <code>.glyphs</code> file using the Docker image:</p>
<div class="highlight"><pre><span></span><code class="language-bash">docker run -it --rm <span class="se">\</span>
    -v <span class="nv">$PWD</span>:/opt/FiraCode <span class="se">\</span>
    tonsky/firacode ./FiraCode/script/build.sh
</code></pre></div>

<p>To set a different font name for the feature fixed fonts, I use <a href="https://twardoch.github.io/fonttools-opentype-feature-freezer/">pyftfeatfreeze</a>:</p>
<div class="highlight"><pre><span></span><code class="language-bash">parallel <span class="se">\</span>
    pyftfeatfreeze <span class="se">\</span>
        --suffix --usesuffix<span class="o">=</span><span class="s2">&quot;&#39;ss01 ss03 ss05 ss08&#39;&quot;</span> <span class="se">\</span>
        -v -n <span class="se">\</span>
        <span class="s1">&#39;{}&#39;</span> <span class="s1">&#39;features_enabled/{/.}.ss1358_enabled.ttf&#39;</span> <span class="se">\</span>
        ::: ttf/*.ttf
</code></pre></div></section>
    <footer class="post-footer">
	<section
		class="utterances"
		data-repo="ccwang002/ccwang002.github.io"
		data-issue-term="pathname"
		data-label="Comment">
	</section>
	</footer>
</article>
	</main>
	<footer class="site-footer">
		<a class="subscribe"
			href="https://blog.liang2.tw/feeds/all.atom.xml"
			data-tooltip="Atom feed"
		>
			<svg viewBox="0 0 24 24" width="24" height="24" alt="Atom feed">
				<circle cx="6.18" cy="17.82" r="2.18"/>
				<path d="m4 10.1v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9zm0-5.66v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56z"/>
			</svg>
		</a>
		<div class="inner">
			<section>
				Browse articles by
				<a href="https://blog.liang2.tw/tags.html">Tags</a> |
				<a href="https://blog.liang2.tw/categories.html">Categories</a>
			</section>
			<section class="contact">
				Contact me by
				<a href="https://twitter.com/lbwang2">Twitter</a> |
				<a href="https://www.facebook.com/lbwang.2">Facebook</a> |
				<a href="https://github.com/ccwang002">GitHub</a> |
				<a href="mailto:me+blog@liang2.tw">Email</a> |
				<a href="https://www.linkedin.com/in/liangbowang/">LinkedIn</a>
			</section>
			<section class="copyright">
				This work is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
			</section>
			<section class="poweredby">
				Built using <a href="https://getpelican.com/">Pelican</a>.
				Powered by the <a href="https://kura.github.io/hauntr/">Hauntr</a> theme.
			</section>
		</div>
	</footer>
	<script src="https://blog.liang2.tw/theme/scripts/theme-toggle.js"></script>
</body>
</html>