<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">
<meta name="author" content="Liang-Bo Wang" />
<meta name="description" content="A walk through of practices created by Rosalind Team." />
<meta name="keywords" content="en, labcoding, python">
	<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.95em%22 font-size=%2295%22>ğŸ“–</text></svg>">
	<title>Coding åˆå­¸æŒ‡å—é™„éŒ„ - Bioinfo Practices using Python</title>

	<!-- og -->
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Liang-Bo Wang's Blog"/>
<meta property="og:title" content="Coding åˆå­¸æŒ‡å—é™„éŒ„ - Bioinfo Practices using Python"/>
<meta property="og:description" content="A walk through of practices created by Rosalind Team."/>
<meta property="og:locale" content=""/>
<meta property="og:url" content="https://blog.liang2.tw/posts/2016/01/lab-coding-appendix-bioinfo-python/"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-01-21 23:30:00-06:00"/>
<meta property="article:modified_time" content="2022-02-20 20:07:45.274008-06:00"/>
<meta property="article:author" content="https://blog.liang2.tw/author/liang-bo-wang.html">
<meta property="article:section" content="Coding"/>
<meta property="article:tag" content="en"/>
<meta property="article:tag" content="labcoding"/>
<meta property="article:tag" content="python"/>
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@ccwang002">
<meta name="twitter:title" content="Coding åˆå­¸æŒ‡å—é™„éŒ„ - Bioinfo Practices using Python">
<meta name="twitter:description" content="A walk through of practices created by Rosalind Team.">

	<!-- Feeds -->
	<link href="https://blog.liang2.tw/feeds/all.atom.xml"
		type="application/atom+xml" rel="alternate" title="Liang-Bo Wang's Blog" />

	<link rel="stylesheet" type="text/css" href="https://blog.liang2.tw/theme/styles/styles.css" />
	<link rel="stylesheet" type="text/css" href="https://blog.liang2.tw/theme/katex-0.15.3/katex.min.css">
</head>

<body class="post-template">
	<header class="site-head">
		<h1 class="blog-title"><a href="https://blog.liang2.tw">Liang-Bo Wang's Blog</a></h1>
		<h2 class="blog-description">
			<a href="https://blog.liang2.tw/about-me/">About</a> |
			<a href="https://blog.liang2.tw/talks/">Talks</a> |
			<a href="https://blog.liang2.tw/archives.html">Archives</a> |
			<svg class="theme-toggle" width="24" height="24" viewBox="0 0 24 24" aria-label="auto" aria-live="polite">
				<path class="moon" fill="currentColor" d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z" />
				<path class="sun" fill="currentColor" d="M3.55 19.09L4.96 20.5L6.76 18.71L5.34 17.29M12 6C8.69 6 6 8.69 6 12S8.69 18 12 18 18 15.31 18 12C18 8.68 15.31 6 12 6M20 13H23V11H20M17.24 18.71L19.04 20.5L20.45 19.09L18.66 17.29M20.45 5L19.04 3.6L17.24 5.39L18.66 6.81M13 1H11V4H13M6.76 5.39L4.96 3.6L3.55 5L5.34 6.81L6.76 5.39M1 13H4V11H1M13 20H11V23H13"></path>
			</svg>
		</h2>
	</header>
	<main id="content" class="content" role="main">
<article class="post">
    <span class="post-meta">
        <time datetime="2016-01-21">Jan 21, 2016</time>
        in <a href="https://blog.liang2.tw/category/coding/">Coding</a>
    </span>
    <h1 class="post-title">
        <a href="https://blog.liang2.tw/posts/2016/01/lab-coding-appendix-bioinfo-python/" rel="bookmark" title="Permalink to Coding åˆå­¸æŒ‡å—é™„éŒ„ - Bioinfo Practices using Python">Coding åˆå­¸æŒ‡å—é™„éŒ„ - Bioinfo Practices using Python</a>
    </h1>
    <span class="post-meta">
                <a href="https://blog.liang2.tw/tag/en/">en</a>
                <a href="https://blog.liang2.tw/tag/labcoding/">labcoding</a>
                <a href="https://blog.liang2.tw/tag/python/">python</a>
    </span>
    <section class="post-content"><p>Last Edited: Jan, 2016 ï¼ˆå¦‚æœå…§å®¹æœ‰èª¤ï¼Œä½ å¯ä»¥ç•™è¨€ï¼Œæˆ–ç”¨ä»»ä½•ç®¡é“å‘Šè¨´æˆ‘ï¼‰</p>
<p>We are going to walk through a series of practice created by <a href="http://rosalind.info/problems/">Rosalind Team</a>.</p>
<p>Once you register an account at Rosalind, you can use their judging system to work through all problems. However, in this case you cannot arbitrarily skip easy levels and it sucks. So I&rsquo;m not going to force you using the system. Luckily, in each problem one set of example data and expected output is given, which can be used for checking our answer.</p>
<p>Note: Their code assumes Python 2 but everything I mention here is Python 3.</p>
<div class="toc">
<ul>
<li><a href="#python-basics">Python Basics</a></li>
<li><a href="#bininfo-first-try">Bininfo First Try</a><ul>
<li><a href="#q-dna-counting-dna-nucleotides">Q DNA: Counting DNA Nucleotides</a></li>
<li><a href="#q-revc-the-secondary-and-tertiary-structures-of-dna">Q REVC: The Secondary and Tertiary Structures of DNA</a></li>
<li><a href="#q-gc-computing-gc-content">Q: GC: Computing GC Content</a><ul>
<li><a href="#workthrough">Workthrough</a></li>
</ul>
</li>
<li><a href="#q-next">Q: (next?)</a></li>
</ul>
</li>
</ul>
</div>
<blockquote>
<p><strong>å…¶ä»– Coding åˆå­¸æŒ‡å—ç³»åˆ—æ–‡ç« ï¼š</strong></p>
<ul>
<li><a href="https://blog.liang2.tw/posts/2016/01/lab-coding-intro/">Introduction</a></li>
<li><a href="https://blog.liang2.tw/posts/2016/01/lab-coding-linux/">Chapter 1 &ndash; Linux</a></li>
<li><a href="https://blog.liang2.tw/posts/2016/01/lab-coding-text-editing/">Chapter 2 &ndash; Text Editing (Markdown, Text Editor)</a></li>
<li><a href="https://blog.liang2.tw/posts/2016/01/lab-coding-version-control/">Chapter 3 &ndash; Version Control (Git)</a></li>
<li><a href="https://blog.liang2.tw/posts/2016/01/lab-coding-python/">Chapter 4 &ndash; Python</a></li>
<li><a href="https://blog.liang2.tw/posts/2016/01/lab-coding-appendix-osx-env/">Appendix 1 &ndash; OSX Development Environment</a></li>
<li><a href="https://blog.liang2.tw/posts/2016/01/lab-coding-appendix-bioinfo-python/">Appendix 2 &ndash; Python in Bioinformatics</a></li>
</ul>
<p>æˆ–è€…ï¼Œç”¨ <a href="/tag/labcoding.html">labcoding</a> é€™å€‹ tag ä¹Ÿå¯ä»¥æ‰¾åˆ°æ‰€æœ‰çš„æ–‡ç« ã€‚</p>
</blockquote>
<h2 id="python-basics">Python Basics</h2>
<p>Do their <a href="http://rosalind.info/problems/list-view/?location=python-village">Python Village</a> problem sets. If any topic you don&rsquo;t know, go read your Python reference.</p>
<p>Should be very trivial.</p>
<h2 id="bininfo-first-try">Bininfo First Try</h2>
<h3 id="q-dna-counting-dna-nucleotides">Q DNA: Counting DNA Nucleotides</h3>
<p>Link: <a href="http://rosalind.info/problems/dna/">http://rosalind.info/problems/dna/</a></p>
<ul>
<li>Hint: use <a href="https://docs.python.org/3/library/collections.html#collections.Counter">collections.Counter</a> provided by Python&rsquo;s stdlib</li>
<li>More Hint: use <code>' '.join</code> and list comprehension to output the answer</li>
</ul>
<h3 id="q-revc-the-secondary-and-tertiary-structures-of-dna">Q REVC: The Secondary and Tertiary Structures of DNA</h3>
<p>Link: <a href="http://rosalind.info/problems/revc/">http://rosalind.info/problems/revc/</a></p>
<ul>
<li>Hint: <a href="https://docs.python.org/3/library/functions.html#reversed">reversed</a> for any sequence object and a dict for nucleotide code mapping</li>
<li>More Hint: done in a list comprehension</li>
</ul>
<h3 id="q-gc-computing-gc-content">Q: GC: Computing GC Content</h3>
<p>Link: <a href="http://rosalind.info/problems/gc/">http://rosalind.info/problems/gc/</a></p>
<p>This is the first complicated problem that some abstraction should help you come up the solution. Try write some re-usable code blocks, for example, function calls and class definitions.</p>
<p>Don&rsquo;t worry about the computation complexity</p>
<h4 id="workthrough">Workthrough</h4>
<p><em>You should implement by yourself before looking my solution. Also I didn&rsquo;t see their official solution so my solution can differ a lot from theirs.</em></p>
<p>Intuitively, we need to implement a FASTA file parser. FASTA contains a series of sequence reads with unique ID. From a object-oriented viewpoint, we create classes <code>Read</code> for reads and <code>Fasta</code> for fasta files.</p>
<p><code>Read</code> is easy to design and understand,</p>
<div class="highlight"><pre><span></span><code class="language-python"><span class="k">class</span> <span class="nc">Read</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">seq</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span>
</code></pre></div>

<p>Since we need to compute their GC content, add a method for <code>Read</code>.</p>
<div class="highlight"><pre><span></span><code class="language-python"><span class="k">class</span> <span class="nc">Read</span><span class="p">:</span>
    <span class="c1"># ... skipped</span>
    <span class="k">def</span> <span class="nf">gc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the GC content (in %) of the read.&quot;&quot;&quot;</span>
        <span class="c1"># put the logic here (think of problem Q DNA)</span>
        <span class="n">gc_percent</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gc_percent</span>
</code></pre></div>

<p>Then we have to implement the FASTA parser, which reads all read entries and converts them through <code>Read</code>. In real world we are dealing with <code>myfasta.fa</code>-like files, but here the input is string.</p>
<div class="highlight"><pre><span></span><code class="language-python"><span class="k">class</span> <span class="nc">Fasta</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse a FASTA formated string.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_str</span> <span class="o">=</span> <span class="n">raw_str</span>
        <span class="c1"># convert string into structured reads.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reads</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse the string and yield read in Read class.&quot;&quot;&quot;</span>
        <span class="c1"># though we have no idea right now, the code structure</span>
        <span class="c1"># should be something like the following.</span>
        <span class="n">raw_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_str</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">raw_lines</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">Read</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</code></pre></div>

<p>Here I use <code>yield Read(...)</code>, which may be unfamiliar for Python beginners. It turns <code>parse(self)</code> function as a generator. Generator makes you focus on the incoming data. Once data is parsed and converted, the result is immediated thrown out by <code>yield</code>. We don&rsquo;t care about how to collect all the results. In our case, we catch all the results into a list by <code>list(...)</code>.</p>
<p>So how should we read FASTA file? A simple rule in this case is that every read consists by two continuous row. Also, the first row will always be the first read id.</p>
<p>All we need is read two lines at the same time. Here <a href="https://docs.python.org/3/library/functions.html#zip">a Pythonic idiom</a> is introduced. The following code read two non-overlapping lines,</p>
<div class="highlight"><pre><span></span><code class="language-python"><span class="k">for</span> <span class="n">first_line</span><span class="p">,</span> <span class="n">second_line</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">iter</span><span class="p">(</span><span class="n">raw_lines</span><span class="p">)]</span><span class="o">*</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">yield</span> <span class="n">Read</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">first_line</span><span class="p">,</span> <span class="n">seq</span><span class="o">=</span><span class="n">second_line</span><span class="p">)</span>
</code></pre></div>

<p>By <code>zip(*[iter(s)]*n)</code> magic, we are very close to implement a full parser. You could find a lot of <a href="http://stackoverflow.com/a/2233247">explanations</a> for this magic.</p>
<p>Read id line percedes with a <code>&gt;</code> sign, so we could use something like <code>first_line[1:]</code> or <code>first_line[len('&gt;'):]</code> for explicity.</p>
<p>Then sorting the GC% of reads in a FASTA file is easy.</p>
<div class="highlight"><pre><span></span><code class="language-python"><span class="n">fasta</span> <span class="o">=</span> <span class="n">Fasta</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
<span class="n">sorted_reads</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">fasta</span><span class="o">.</span><span class="n">reads</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">gc</span><span class="p">())</span>  <span class="c1"># note 1</span>
<span class="n">top_gc_read</span> <span class="o">=</span> <span class="n">sorted_reads</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># note 2</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s1">&#39;&gt;</span><span class="si">{0:s}</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="s1">&#39;</span><span class="si">{1:.6f}</span><span class="s1">&#39;</span>  <span class="c1"># note 3, 4</span>
    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_gc_read</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">top_gc_read</span><span class="o">.</span><span class="n">gc</span><span class="p">())</span>
<span class="p">)</span>
</code></pre></div>

<p>The code above completes the following steps:</p>
<ol>
<li><code>sorted(list, key=key_func)</code> sorts the list based on the return value of key_func applied to each element.</li>
<li>or <code>top_gc_read = sorted(..., reversed=True)[0]</code></li>
<li>two string with no operands in between will be joint automatically. In this case it is exactly <code>&gt;{0:s}\n{1:.6f}</code>. This is useful to tidy a super long string.</li>
<li><code>'...'.format()</code> fills the string with given values. See <a href="https://docs.python.org/3/library/string.html#formatspec">doc</a>.</li>
</ol>
<p>In real case FASTA can span across multiple lines, also likely the file we parse is broken. How could we modify this parser to handle these situations?</p>
<h3 id="q-next">Q: (next?)</h3>
<p>I&rsquo;m super tired now so I&rsquo;ll leave the rest for you. Try those problems within yellow correct ratio range.</p></section>
    <footer class="post-footer">
	<section
		class="utterances"
		data-repo="ccwang002/ccwang002.github.io"
		data-issue-term="pathname"
		data-label="Comment">
	</section>
	</footer>
</article>
	</main>
	<footer class="site-footer">
		<a class="subscribe"
			href="https://blog.liang2.tw/feeds/all.atom.xml"
			data-tooltip="Atom feed"
		>
			<svg viewBox="0 0 24 24" width="24" height="24" alt="Atom feed">
				<circle cx="6.18" cy="17.82" r="2.18"/>
				<path d="m4 10.1v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9zm0-5.66v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56z"/>
			</svg>
		</a>
		<div class="inner">
			<section>
				Browse articles by
				<a href="https://blog.liang2.tw/tags.html">Tags</a> |
				<a href="https://blog.liang2.tw/categories.html">Categories</a>
			</section>
			<section class="contact">
				Contact me by
				<a href="https://twitter.com/lbwang2">Twitter</a> |
				<a href="https://www.facebook.com/lbwang.2">Facebook</a> |
				<a href="https://github.com/ccwang002">GitHub</a> |
				<a href="mailto:me+blog@liang2.tw">Email</a> |
				<a href="https://www.linkedin.com/in/liangbowang/">LinkedIn</a>
			</section>
			<section class="copyright">
				This work is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
			</section>
			<section class="poweredby">
				Built using <a href="https://getpelican.com/">Pelican</a>.
				Powered by the <a href="https://kura.github.io/hauntr/">Hauntr</a> theme.
			</section>
		</div>
	</footer>
	<script src="https://blog.liang2.tw/theme/scripts/theme-toggle.js"></script>
</body>
</html>