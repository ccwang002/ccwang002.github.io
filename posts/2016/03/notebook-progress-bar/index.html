<!DOCTYPE html>
<html lang="zh-Hant">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Liang-Bo Wang" />
<meta name="description" content="ç›¸ä¿¡å¾ˆå¤šäººéƒ½å·²ç¶“åœ¨ä½¿ç”¨ Jupyter (IPython) Notebook è·‘åˆ†æã€‚éš¨è‘—åˆ†æçš„è³‡æ–™è¶Šè·‘è¶Šå¤šï¼Œæœ‰æ™‚å€™åˆ·ä¸‹å»å°±æ˜¯å¹¾ååˆ†é˜ç”šè‡³æ•¸å°æ™‚ã€‚æ­¤æ™‚æ²’æœ‰å€‹ â€¦" />
<meta name="keywords" content="zh, jupyter, notebook">
	<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.95em%22 font-size=%2295%22>ğŸ“–</text></svg>">
	<title>Jupyter Notebook Progress Bar</title>

	<!-- og -->
<meta property="og:locale" content="zh_TW"/>
<meta property="og:site_name" content="Liang-Bo Wang's Blog"/>
<meta property="og:title" content="Jupyter Notebook Progress Bar"/>
<meta property="og:description" content="ç›¸ä¿¡å¾ˆå¤šäººéƒ½å·²ç¶“åœ¨ä½¿ç”¨ Jupyter (IPython) Notebook è·‘åˆ†æã€‚éš¨è‘—åˆ†æçš„è³‡æ–™è¶Šè·‘è¶Šå¤šï¼Œæœ‰æ™‚å€™åˆ·ä¸‹å»å°±æ˜¯å¹¾ååˆ†é˜ç”šè‡³æ•¸å°æ™‚ã€‚æ­¤æ™‚æ²’æœ‰å€‹ â€¦"/>
<meta property="og:locale" content=""/>
<meta property="og:url" content="https://blog.liang2.tw/posts/2016/03/notebook-progress-bar/"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-03-23 02:00:00-05:00"/>
<meta property="article:modified_time" content="2022-05-13 12:58:45.938118-05:00"/>
<meta property="article:author" content="https://blog.liang2.tw/author/liang-bo-wang.html">
<meta property="article:section" content="Coding"/>
<meta property="article:tag" content="zh"/>
<meta property="article:tag" content="jupyter"/>
<meta property="article:tag" content="notebook"/>
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@ccwang002">
<meta name="twitter:title" content="Jupyter Notebook Progress Bar">
<meta name="twitter:description" content="ç›¸ä¿¡å¾ˆå¤šäººéƒ½å·²ç¶“åœ¨ä½¿ç”¨ Jupyter (IPython) Notebook è·‘åˆ†æã€‚éš¨è‘—åˆ†æçš„è³‡æ–™è¶Šè·‘è¶Šå¤šï¼Œæœ‰æ™‚å€™åˆ·ä¸‹å»å°±æ˜¯å¹¾ååˆ†é˜ç”šè‡³æ•¸å°æ™‚ã€‚æ­¤æ™‚æ²’æœ‰å€‹ â€¦">
<meta property="og:image" content="https://blog.liang2.tw/posts/2016/03/notebook-progress-bar/pics/progressbar_demo.webm">
<meta name="twitter:image" content="https://blog.liang2.tw/posts/2016/03/notebook-progress-bar/pics/progressbar_demo.webm">

	<!-- Feeds -->
	<link href="https://blog.liang2.tw/feeds/all.atom.xml"
		type="application/atom+xml" rel="alternate" title="Liang-Bo Wang's Blog" />

	<link rel="stylesheet" type="text/css" href="https://blog.liang2.tw/theme/styles/styles.css" />
	<link rel="stylesheet" href="https://blog.liang2.tw/theme/styles/pygments/light.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light" />
    <link rel="stylesheet" href="https://blog.liang2.tw/theme/styles/pygments/dark-monokai.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark" />
	<link rel="stylesheet" type="text/css" href="https://blog.liang2.tw/theme/katex-0.16.2/katex.min.css">
</head>

<body class="post-template no-js">
	<script>document.body.classList.remove('no-js');</script>
<svg
	xmlns="http://www.w3.org/2000/svg"
	style="display: none;"
>
	<symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
		<title>Following system color scheme</title>
		<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
			stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
			<circle cx="12" cy="12" r="9"></circle>
			<path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
		</svg>
	</symbol>
	<symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
		<title>Selected dark color scheme</title>
		<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
			stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
			<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
			<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
		</svg>
	</symbol>
	<symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
		<title>Selected light color scheme</title>
		<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
			stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
			<circle cx="12" cy="12" r="5"></circle>
			<line x1="12" y1="1" x2="12" y2="3"></line>
			<line x1="12" y1="21" x2="12" y2="23"></line>
			<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
			<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
			<line x1="1" y1="12" x2="3" y2="12"></line>
			<line x1="21" y1="12" x2="23" y2="12"></line>
			<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
			<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
		</svg>
	</symbol>
</svg>

<script>
	document.documentElement.dataset.color_scheme = localStorage.getItem("color_scheme") || "auto"
</script>
	<header class="site-head">
		<h1 class="blog-title"><a href="https://blog.liang2.tw">Liang-Bo Wang's Blog</a></h1>
		<h2 class="blog-description">
			<a href="https://blog.liang2.tw/about-me/">About</a> |
			<a href="https://blog.liang2.tw/talks/">Talks</a> |
			<a href="https://blog.liang2.tw/archives.html">Archives</a> |
			<button id="color-scheme-cycler" onClick="setColorScheme(nextColorScheme())">
                <svg aria-hidden="true" class="color-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="color-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="color-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="sr-only">Toggle light / dark / auto color theme</span>
            </button>
		</h2>
	</header>
	<main id="content" class="content" role="main">
<article class="post">
    <span class="post-meta">
        <time datetime="2016-03-23">Mar 23, 2016</time>
        in <a href="https://blog.liang2.tw/category/coding/">Coding</a>
    </span>
    <h1 class="post-title">
        <a href="https://blog.liang2.tw/posts/2016/03/notebook-progress-bar/" rel="bookmark" title="Permalink to Jupyter Notebook Progress Bar">Jupyter Notebook Progress Bar</a>
    </h1>
    <span class="post-meta">
                <a href="https://blog.liang2.tw/tag/zh/">zh</a>
                <a href="https://blog.liang2.tw/tag/jupyter/">jupyter</a>
                <a href="https://blog.liang2.tw/tag/notebook/">notebook</a>
    </span>
    <section class="post-content"><p>ç›¸ä¿¡å¾ˆå¤šäººéƒ½å·²ç¶“åœ¨ä½¿ç”¨ <a href="https://jupyter.org/">Jupyter (IPython) Notebook</a> è·‘åˆ†æã€‚éš¨è‘—åˆ†æçš„è³‡æ–™è¶Šè·‘è¶Šå¤šï¼Œæœ‰æ™‚å€™åˆ·ä¸‹å»å°±æ˜¯å¹¾ååˆ†é˜ç”šè‡³æ•¸å°æ™‚ã€‚æ­¤æ™‚æ²’æœ‰å€‹é€²åº¦æ¢é‚„è »ç„¡èŠçš„ï¼Œè€Œä¸”èƒ½è®“è‡ªå·±æ„Ÿè¦º<strong>å¾ˆæœ‰é€²åº¦</strong>ï¼Œä½•æ¨‚ä¸ç‚ºå‘¢ï¼Ÿ</p>
<p>ä¾‹å¦‚æˆ‘<a href="https://blog.liang2.tw/play_aiohttp/?full#asyncio-progressbar-cover">å»å¹´ä»‹ç´¹ aiohttp</a> æ™‚å°±æœ‰ç”¨åˆ° notebook å’Œ console åº•ä¸‹çš„é€²åº¦æ¢ (progress bar)ã€‚ä¸éï¼Œé€™å¹¾å€‹æœˆ Jupyter Notebook 4+ æ¶æ§‹ä¸Šçš„èª¿æ•´ï¼Œå¯èƒ½ code éƒ½ä¸èƒ½ç”¨äº†ã€‚å‰›å¥½æ˜¨å¤©çš„ Taipei.py æœ‰äººæåˆ°é€™äº‹ï¼Œå°±ä¾†æ•´ç†ä¸€ä¸‹å§ã€‚</p>
<div class="toc">
<ul>
<li><a href="#ipywidgets">IPywidgets ä»‹ç´¹</a><ul>
<li><a href="#_1">å®‰è£</a></li>
</ul>
</li>
<li><a href="#_2">ä½¿ç”¨é€²åº¦æ¢</a></li>
<li><a href="#progress-bar-example-in-action">Progress bar example in action</a></li>
<li><a href="#misc">Misc. è¢å¹•æˆªåœ–</a><ul>
<li><a href="#ffmpeg">FFmpeg è½‰æª”</a></li>
</ul>
</li>
</ul>
</div>
<h3 id="ipywidgets">IPywidgets ä»‹ç´¹</h3>
<p>Notebook é€²åº¦æ¢ä½¿ç”¨ <a href="https://github.com/ipython/ipywidgets">ipywidgets</a> ä¸­çš„å…ƒä»¶å¯¦ä½œã€‚é€™ä»¶å…ƒä»¶è¦ç¯„äº† notebook client &lt;-&gt; server é–“é›™å‘çš„æºé€šï¼Œä¸¦ä¸”èƒ½æŠŠç›¸é—œçš„ CSS / JS åŒ…è£åœ¨ä¸€èµ·ã€‚åœ¨ ipywidgets ç¯„ä¾‹çš„ <a href="http://nbviewer.jupyter.org/github/ipython/ipywidgets/blob/master/examples/Widget%20Basics.ipynb"><em>Widgets Basics</em></a> ä¸­å°±æœ‰æåˆ°å¯èƒ½çš„ç”¨é€”ï¼š</p>
<blockquote>
<p>You can use widgets to <strong>build interactive GUIs</strong> for your notebooks. <br>
You can also use widgets to <strong>synchronize stateful and stateless information</strong> between Python and JavaScript.</p>
</blockquote>
<p>æ‰€ä»¥é™¤äº†åƒé€²åº¦æ¢é€™æ¨£å–®å‘çš„å¾ python code å‚³è¨Šæ¯åˆ° notebook (HTML) front-end ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥åšä¸€äº›ä»‹é¢æŠŠ front-end çš„å€¼å‚³å› python codeã€‚</p>
<p>â€¦â€¦åªæ˜¯è¦ç”¨å€‹é€²åº¦æ¢è€Œå·²ï¼Œå“ªä¾†é€™éº¼å¤šèƒŒæ™¯çŸ¥è­˜ã€‚æ›´å¤šä»‹ç´¹å¯ä»¥åƒè€ƒ <a href="http://nbviewer.jupyter.org/github/ipython/ipywidgets/blob/master/examples/Index.ipynb">ipywidgets å®˜æ–¹ç¯„ä¾‹</a>ã€‚</p>
<h4 id="_1">å®‰è£</h4>
<p>ä½¿ç”¨ Python 3.5 ç¤ºç¯„ã€‚å®‰è£é™¤äº† notebook æœ¬èº«å¤–ï¼Œé‚„è¦é¡å¤–è£ä¸Š ipywidgets é€™å¥—ä»¶ã€‚</p>
<div class="highlight"><pre><span></span><code>pip install notebook ipywidgets
</code></pre></div>

<p>å†ç”¨ <code>jupyter notebook</code> å³å¯å•Ÿç”¨ notebookã€‚</p>
<h3 id="_2">ä½¿ç”¨é€²åº¦æ¢</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">IntProgress</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
</code></pre></div>

<p><code>IntProgress</code> å°±æ˜¯é€²åº¦æ¢ï¼Œ<code>display</code> å‰‡æ˜¯ IPython é¡¯ç¤ºå„ç¨® Python ç‰©ä»¶çš„å‡½æ•¸ï¼Œåœ¨é€™é‚Šç”¨å®ƒæ‰èƒ½æŠŠ widget ä»¥ HTML é¡¯ç¤ºä¸¦èˆ‡ python code è¯å‹•ã€‚</p>
<p>å»ºç«‹ä¸€å€‹é€²åº¦æ¢çš„æ–¹å¼å¾ˆç°¡å–®ã€‚å»ºç«‹ <code>IntProgress</code> widget objectï¼Œç„¶å¾Œé¡¯ç¤ºå®ƒï¼š</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span> <span class="o">=</span> <span class="n">IntProgress</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>

<figure>
  <img src="https://blog.liang2.tw/posts/2016/03/notebook-progress-bar/pics/progressbar_default.png">
</figure>

<p>é è¨­æ˜¯é€²åº¦æ¢æœ‰ 100 å€‹å–®ä½ï¼Œåˆå§‹å€¼ç‚º 0ã€‚é€²åº¦æ¢çš„å€¼èˆ‡æœ€å¤§å€¼çš„ç‹€æ…‹åˆ†åˆ¥å­˜åœ¨ <code>.value</code>ã€<code>.max</code> å±¬æ€§è£¡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">max</span>
<span class="go">(0, 100)</span>
</code></pre></div>

<p>åªè¦ä¿®æ”¹ <code>p.value</code> å‰é¢çš„é€²åº¦æ¢çš„ç‹€æ…‹å°±æœƒè‡ªå‹•æ›´æ–°ï¼ˆä¸ç”¨é‡è·‘ <code>display(p)</code>ï¼‰ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">50</span>
</code></pre></div>

<figure>
  <img src="https://blog.liang2.tw/posts/2016/03/notebook-progress-bar/pics/progressbar_50.png">
</figure>

<div class="highlight"><pre><span></span><code><span class="n">p</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">100</span>
</code></pre></div>

<figure>
  <img src="https://blog.liang2.tw/posts/2016/03/notebook-progress-bar/pics/progressbar_100.png">
</figure>

<p>ç•¶ç„¶ï¼Œæœ€å¤§å€¼èª¿æ•´ä¹Ÿæœƒå³æ™‚æ›´æ–°ã€‚æ­¤å¤–ï¼Œé‚„å¯ä»¥é€é <code>.description</code> çµ¦é€²åº¦æ¢ä¸€å€‹ labelã€‚é‡æ–°åšä¸€å€‹å®Œæ•´çš„ä¾‹å­ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="n">p2</span> <span class="o">=</span> <span class="n">IntProgress</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mi">56</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">10</span>
<span class="n">p2</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Running&#39;</span>
<span class="n">display</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
</code></pre></div>

<figure>
  <img src="https://blog.liang2.tw/posts/2016/03/notebook-progress-bar/pics/progressbar_full.png">
</figure>

<p>å®Œæ•´çš„ code å°±é€™æ¨£ï¼Œç”¨èµ·ä¾†éå¸¸æ–¹ä¾¿ã€‚</p>
<h3 id="progress-bar-example-in-action">Progress bar example in action</h3>
<p>æ¨¡æ“¬ä¸€ä¸‹çœŸå¯¦æƒ…æ³ï¼Œæˆ‘å€‘é€šå¸¸æœ‰ä¸€å †å¾…åšçš„ taskï¼Œåœ¨é€™é‚Šå« <code>todo_tasks</code> å¥½äº†ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>
<span class="n">todo_tasks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;task </span><span class="si">%02d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)]</span>
</code></pre></div>

<p>åªæ˜¯å€‹å­—ä¸²ï¼Œä½†ç”¨ <code>time.sleep(sec)</code> ä¾†æ¨¡æ“¬æœ‰åœ¨åšäº‹ã€‚</p>
<p>æ­é…é€²åº¦æ¢çš„æ™‚å€™ï¼ŒæŠŠå¯¦éš›å‹•æ…‹åšæˆåº•ä¸‹çš„å‹•ç•«ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Initialize a progess bar</span>
<span class="n">progress</span> <span class="o">=</span> <span class="n">IntProgress</span><span class="p">()</span>
<span class="n">progress</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">todo_tasks</span><span class="p">)</span>
<span class="n">progress</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;(Init)&#39;</span>
<span class="n">display</span><span class="p">(</span><span class="n">progress</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># Simulating task execution</span>
<span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">todo_tasks</span><span class="p">:</span>
    <span class="n">progress</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">progress</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">task</span>
<span class="n">progress</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;(Done)&#39;</span>
</code></pre></div>

<figure>
  <video loop auto autoplay>
    <source src="https://blog.liang2.tw/posts/2016/03/notebook-progress-bar/pics/progressbar_demo.webm" type="video/webm">
    <source src="https://blog.liang2.tw/posts/2016/03/notebook-progress-bar/pics/progressbar_demo.mp4" type="video/mp4">
    Your browser doesn't support HTML5 video in WebM with VP8 or MP4 with H.264. You can still download the <a href="https://blog.liang2.tw/posts/2016/03/notebook-progress-bar/pics/progressbar_demo.mp4">screencast</a> and view it locally.
  </video>
  <p class="caption center">Progressbar in action</p>
</figure>

<p>éå¸¸æ–¹ä¾¿å§ï¼</p>
<h3 id="misc">Misc. è¢å¹•æˆªåœ–</h3>
<p>å¯«é€™ç¯‡æ–‡ç« èŠ±æœ€å¤šçš„æ™‚é–“æ˜¯åœ¨æˆªåœ–è·Ÿåšå‹•ç•« XD</p>
<p>ç€è¦½å™¨çš„æˆªåœ–ï¼Œç¾åœ¨ Firefox (45) å·²ç¶“å¯ä»¥åªé¸æ“‡æˆªæŸå€‹ DOMï¼Œååˆ†æ–¹ä¾¿ã€‚</p>
<p>åœ¨æœ€å¾Œå‹•æ…‹çš„éŒ„è£½èŠ±äº†ä¸å°‘æ™‚é–“ã€‚ä¸€é–‹å§‹æƒ³èªªæ˜¯ä¸æ˜¯è¦ç”¨ GIFï¼Œä½†<a href="http://blog.imgur.com/2014/10/09/introducing-gifv/">éƒ½ 2016 å¹´äº†é‚„ç”¨ä»€éº¼ GIF å•Šï¼</a>ï¼Œé›–ç„¶è¢å¹•å¯ä»¥è©¦è‘—æ”¹ GIF palette è®“ç•«é¢ä¸æœƒå¾ˆé†œé«”ç©åˆå°ï¼Œä½†è¦ºå¾—ç”¨å€‹ H.264 / VP9 ç°¡å–®å¤šäº†ã€‚</p>
<p>ä½¿ç”¨ QuickTime Screen Captureï¼Œé–‹å§‹éŒ„çš„æ™‚å€™èƒ½åªé¸æ“‡è¢å¹•ä¸€éƒ¨ä»½å€åŸŸã€‚ä»¥æˆ‘ 13&rdquo; retina è¢å¹•ç‚ºä¾‹ï¼Œæœƒå¾—åˆ° 1636x736 H.264 .mov æª”ã€‚ä½†æˆ‘è¦ºå¾—è§£æåº¦ä¸ç”¨é€™éº¼é«˜ï¼Œæ‰€ä»¥æœ€å¾Œè¼¸å‡ºæˆ 480p (1148x480)  å°±å¥½ï¼Œé †ä¾¿è£äº†ä¸€é»ç™½é‚Šã€‚</p>
<p>é€é HTML5 <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video"><code>&lt;video&gt;</code></a> èƒ½æŠŠ MP4 / WebM ç•¶æˆå‹•ç•«ä¾†ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">video</span> <span class="na">loop</span> <span class="na">autoplay</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">source</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;vid.webm&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;video/webm&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">source</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;vid.mp4&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;video/mp4&quot;</span><span class="p">&gt;</span>
    Your browser doesn&#39;t support HTML5 video in WebM with VP8
    or MP4 with H.264. You can still download the
    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;vid.mp4&quot;</span><span class="p">&gt;</span>screencast<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> and view it locally.
<span class="p">&lt;/</span><span class="nt">video</span><span class="p">&gt;</span>
</code></pre></div>

<p>å„å®¶ web browser çš„æ”¯æ´åº¦å¯åƒè€ƒ caniuse.comï¼š<a href="http://caniuse.com/#feat=webm">WebM</a>ã€<a href="http://caniuse.com/#feat=mpeg4">MP4</a></p>
<h4 id="ffmpeg">FFmpeg è½‰æª”</h4>
<p>ç­†è¨˜è€Œå·²ï¼Œæ²’æœ‰èªçœŸèª¿åƒæ•¸è®“è¼¸å‡ºæª”æ¡ˆæœ€å°ã€‚VP9 çš„éƒ¨ä»½åƒè€ƒ <a href="https://trac.ffmpeg.org/wiki/Encode/VP9">FFmepg</a><sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1"># H.264 MP4</span>
ffmpeg -i Untitled.mov <span class="se">\</span>
    -vcodec h264 <span class="se">\</span>
    -strict -2 -crf <span class="m">22</span> -preset slow -r <span class="m">24</span> <span class="se">\</span>
    -vf <span class="s2">&quot;crop=iw:ih-52:0:10, scale=-1:480&quot;</span> <span class="se">\</span>
    out.mp4

<span class="c1"># VP9 WebM</span>
ffmpeg -i Untitled.mov <span class="se">\</span>
    -vcodec libvpx-vp9 <span class="se">\</span>
    -b:v 150K -r <span class="m">24</span> <span class="se">\</span>
    -vf <span class="s2">&quot;crop=iw:ih-52:0:10, scale=-1:480&quot;</span> <span class="se">\</span>
    out.webm
</code></pre></div>

<p>4s çš„æª”æ¡ˆæœ€å¾Œå¤§ç´„ 60KBï¼Œç›¸ç•¶ä¸éŒ¯ã€‚æˆ‘å¾ˆå¤š PNG æˆªåœ–éƒ½å¤§å¤šäº†ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>du -sh ./* <span class="p">|</span> gsort -rh
<span class="go">744K    ./Untitled.mov</span>
<span class="go"> 60K    ./out.mp4</span>
<span class="go"> 52K    ./out.webm</span>
</code></pre></div>

<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p>éœ€è¦é¡å¤–å®‰è£ libvpxï¼Œä¾‹å¦‚ï¼š<code>brew install ffmepg --with-libvpx</code>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></section>
    <footer class="post-footer">
	<section
		class="utterances"
		data-repo="ccwang002/ccwang002.github.io"
		data-issue-term="pathname"
		data-label="Comment">
	</section>
	</footer>
</article>
	</main>
	<footer class="site-footer">
		<a class="subscribe"
			href="https://blog.liang2.tw/feeds/all.atom.xml"
			aria-label="Subscribe the Atom feed"
			data-tooltip="Subscribe"
		>
			<svg viewBox="0 0 24 24" width="24" height="24">
				<title>Atom feed</title>
				<circle cx="6.18" cy="17.82" r="2.18"/>
				<path d="m4 10.1v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9zm0-5.66v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56z"/>
			</svg>
		</a>
		<div class="inner">
			<section>
				Browse articles by
				<a href="https://blog.liang2.tw/tags.html">Tags</a> |
				<a href="https://blog.liang2.tw/categories.html">Categories</a>
			</section>
			<section class="contact">
				Contact me by
				<a href="https://twitter.com/lbwang2">Twitter</a> |
				<a href="https://www.facebook.com/lbwang.2">Facebook</a> |
				<a href="https://github.com/ccwang002">GitHub</a> |
				<a href="mailto:me+blog@liang2.tw">Email</a> |
				<a href="https://www.linkedin.com/in/liangbowang/">LinkedIn</a>
			</section>
			<section class="copyright">
				This work is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
			</section>
			<section class="powered-by">
				Built using <a href="https://getpelican.com/">Pelican</a>.
				Powered by the <a href="https://github.com/kura/hauntr">Hauntr</a> theme.
			</section>
		</div>
	</footer>
	<script src="https://blog.liang2.tw/theme/scripts/color_scheme.js"></script>
</body>
</html>