<!DOCTYPE html>
<html lang="zh-Hant">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8;charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Liang-Bo Wang" />
<meta name="description" content="æ•´ç†äº† server å¾ HTTP åˆ° HTTPS ç›¸é—œè¨­å®šçš„èª¿æ•´ã€‚" />
<meta name="keywords" content="zh, pydoctw, https, letsencrypt">
	<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.95em%22 font-size=%2295%22>ğŸ“–</text></svg>">
	<title>Python å®˜æ–¹æ–‡ä»¶ä¸­æ–‡åŒ– Server HTTPS ä½¿ç”¨ Let's Encrypt</title>

	<!-- og -->
<meta property="og:locale" content="zh_TW"/>
<meta property="og:site_name" content="Liang-Bo Wang's Blog"/>
<meta property="og:title" content="Python å®˜æ–¹æ–‡ä»¶ä¸­æ–‡åŒ– Server HTTPS ä½¿ç”¨ Let's Encrypt"/>
<meta property="og:description" content="æ•´ç†äº† server å¾ HTTP åˆ° HTTPS ç›¸é—œè¨­å®šçš„èª¿æ•´ã€‚"/>
<meta property="og:locale" content=""/>
<meta property="og:url" content="https://blog.liang2.tw/posts/2016/02/pydoctw-https/"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-02-21 14:00:00-06:00"/>
<meta property="article:modified_time" content="2022-05-13 12:58:39.552851-05:00"/>
<meta property="article:author" content="https://blog.liang2.tw/author/liang-bo-wang.html">
<meta property="article:section" content="Coding"/>
<meta property="article:tag" content="zh"/>
<meta property="article:tag" content="pydoctw"/>
<meta property="article:tag" content="https"/>
<meta property="article:tag" content="letsencrypt"/>
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@ccwang002">
<meta name="twitter:title" content="Python å®˜æ–¹æ–‡ä»¶ä¸­æ–‡åŒ– Server HTTPS ä½¿ç”¨ Let's Encrypt">
<meta name="twitter:description" content="æ•´ç†äº† server å¾ HTTP åˆ° HTTPS ç›¸é—œè¨­å®šçš„èª¿æ•´ã€‚">

	<!-- Feeds -->
	<link href="https://blog.liang2.tw/feeds/all.atom.xml"
		type="application/atom+xml" rel="alternate" title="Liang-Bo Wang's Blog" />

	<link rel="stylesheet" type="text/css" href="https://blog.liang2.tw/theme/styles/styles.css" />
	<link rel="stylesheet" href="https://blog.liang2.tw/theme/styles/pygments/light.css" type="text/css" media="(prefers-color-scheme: light)" id="pyg-light" />
    <link rel="stylesheet" href="https://blog.liang2.tw/theme/styles/pygments/dark-monokai.css" type="text/css" media="(prefers-color-scheme: dark)" id="pyg-dark" />
	<link rel="stylesheet" type="text/css" href="https://blog.liang2.tw/theme/katex-0.15.3/katex.min.css">
</head>

<body class="post-template no-js">
	<script>document.body.classList.remove('no-js');</script>
<svg
	xmlns="http://www.w3.org/2000/svg"
	style="display: none;"
>
	<symbol id="svg-sun-half" viewBox="0 0 24 24" pointer-events="all">
		<title>Following system color scheme</title>
		<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
			stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
			<circle cx="12" cy="12" r="9"></circle>
			<path d="M12 3v18m0-12l4.65-4.65M12 14.3l7.37-7.37M12 19.6l8.85-8.85"></path>
		</svg>
	</symbol>
	<symbol id="svg-moon" viewBox="0 0 24 24" pointer-events="all">
		<title>Selected dark color scheme</title>
		<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
			stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
			<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
			<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
		</svg>
	</symbol>
	<symbol id="svg-sun" viewBox="0 0 24 24" pointer-events="all">
		<title>Selected light color scheme</title>
		<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
			stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
			<circle cx="12" cy="12" r="5"></circle>
			<line x1="12" y1="1" x2="12" y2="3"></line>
			<line x1="12" y1="21" x2="12" y2="23"></line>
			<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
			<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
			<line x1="1" y1="12" x2="3" y2="12"></line>
			<line x1="21" y1="12" x2="23" y2="12"></line>
			<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
			<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
		</svg>
	</symbol>
</svg>

<script>
	document.documentElement.dataset.color_scheme = localStorage.getItem("color_scheme") || "auto"
</script>
	<header class="site-head">
		<h1 class="blog-title"><a href="https://blog.liang2.tw">Liang-Bo Wang's Blog</a></h1>
		<h2 class="blog-description">
			<a href="https://blog.liang2.tw/about-me/">About</a> |
			<a href="https://blog.liang2.tw/talks/">Talks</a> |
			<a href="https://blog.liang2.tw/archives.html">Archives</a> |
			<button id="color-scheme-cycler" onClick="setColorScheme(nextColorScheme())">
                <svg aria-hidden="true" class="color-scheme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                <svg aria-hidden="true" class="color-scheme-icon-when-dark"><use href="#svg-moon"></use></svg>
                <svg aria-hidden="true" class="color-scheme-icon-when-light"><use href="#svg-sun"></use></svg>
                <span class="sr-only">Toggle light / dark / auto color theme</span>
            </button>
		</h2>
	</header>
	<main id="content" class="content" role="main">
<article class="post">
    <span class="post-meta">
        <time datetime="2016-02-21">Feb 21, 2016</time>
        in <a href="https://blog.liang2.tw/category/coding/">Coding</a>
    </span>
    <h1 class="post-title">
        <a href="https://blog.liang2.tw/posts/2016/02/pydoctw-https/" rel="bookmark" title="Permalink to Python å®˜æ–¹æ–‡ä»¶ä¸­æ–‡åŒ– Server HTTPS ä½¿ç”¨ Let's Encrypt">Python å®˜æ–¹æ–‡ä»¶ä¸­æ–‡åŒ– Server HTTPS ä½¿ç”¨ Let's Encrypt</a>
    </h1>
    <span class="post-meta">
                <a href="https://blog.liang2.tw/tag/zh/">zh</a>
                <a href="https://blog.liang2.tw/tag/pydoctw/">pydoctw</a>
                <a href="https://blog.liang2.tw/tag/https/">https</a>
                <a href="https://blog.liang2.tw/tag/letsencrypt/">letsencrypt</a>
    </span>
    <section class="post-content"><p>ç¾åœ¨å¯ä»¥é€é <a href="https://docs.python.org.tw">https://docs.python.org.tw</a> è¨ªå• Python å®˜æ–¹æ–‡ä»¶ä¸­æ–‡åŒ–ç¶²ç«™ã€‚</p>
<p>Server æœ¬èº«çš„è¨­å®šå¯ä»¥åƒè€ƒ<a href="https://blog.liang2.tw/posts/2016/02/pydoctw-server/">ä¹‹å‰çš„æ–‡ç« </a>ã€‚åŠ å…¥ HTTPS å°±è¦è¨­å®šç›¸é—œçš„æ†‘è¨¼ï¼Œæˆ‘é¸æ“‡ <a href="https://letsencrypt.org/">Let&rsquo;s Encrypt</a> åšç‚ºæ†‘è¨¼çš„ç°½ç½²è€…ã€‚</p>
<p>Let&rsquo;s Encrypt (LE) ä½¿ç”¨ AMCE (Automated Certificate Management Environment) protocol å»é©—è¨¼ä½ æ˜¯å¦æ“æœ‰ä½ æ¬²ç°½è¨¼çš„ domainã€‚å®˜ç¶²ä¸Šæœ‰<a href="https://letsencrypt.org/howitworks/technology/">åœ–æ–‡èªªæ˜</a>ï¼Œç°¡å–®ä¾†èªªï¼ŒLE æœƒè¦æ±‚ä½ çš„ server åœ¨ç‰¹å®šçš„ path åŠ å…¥ç‰¹å®šçš„æª”æ¡ˆï¼Œå¦‚æœä½ åšå¾—åˆ°ï¼Œå°±ä»£è¡¨ä½ æ“æœ‰é€™å€‹ domainã€‚é€™æ¨£çš„ç°½è¨¼ç¬¬ä¸€æ¬¡è¦åœ¨ LE server ä¸Šè¨»å†Šï¼Œä¹‹å¾Œæœ€é•·æ¯ 90 å¤©èªè¨¼ä¸€æ¬¡ã€‚</p>
<div class="toc">
<ul>
<li><a href="#_1">åƒè€ƒè³‡æ–™</a></li>
<li><a href="#lets-encrypt-certificate">Let&rsquo;s Encrypt Certificate</a></li>
<li><a href="#systemd-timer-certificate">è¨­å®š systemd timer å®šæ™‚æ›´æ–° certificate</a><ul>
<li><a href="#systemd-service">Systemd service</a></li>
<li><a href="#systemd-timer">Systemd Timer</a></li>
</ul>
</li>
<li><a href="#nginx-http-redirect-to-https">nginx HTTP redirect to HTTPS</a></li>
<li><a href="#https">æ¸¬è©¦ HTTPS è¨­å®š</a></li>
<li><a href="#_2">å¿ƒå¾—</a></li>
<li><a href="#misc">Misc.</a></li>
</ul>
</div>
<h3 id="_1">åƒè€ƒè³‡æ–™</h3>
<p>æˆ‘ä¸æ˜¯ç¶²è·¯å®‰å…¨ç›¸é—œçš„å°ˆå®¶ï¼Œè¨­å®šéƒ½æ˜¯åƒè€ƒç¶²è·¯ä¸Šçš„èªªæ˜æ•´ç†è€Œæˆã€‚LE certificate çš„è¨­å®šåƒè€ƒ <a href="https://robmclarty.com/blog/how-to-secure-your-web-app-using-https-with-letsencrypt"><em>How to Secure Your Web App Using HTTPS With Letsencrypt</em></a> by Rob McLarty é€™ç¯‡æ–‡ç« ã€‚</p>
<h3 id="lets-encrypt-certificate">Let&rsquo;s Encrypt Certificate</h3>
<p>æ²’æœ‰ä½¿ç”¨ LE å®˜æ–¹çš„ clientï¼Œè€Œæ˜¯ç”¨ <a href="https://daylightpirates.org/">Daniel Roesler</a> æ‰€å¯«çš„ <a href="https://github.com/diafygi/acme-tiny/">acme-tiny</a>ã€‚é€™æ˜¯ä¸€å€‹ä¸åˆ° 200 è¡Œçš„ Python scriptï¼Œå¯ä»¥è‡ªè¡Œæª¢æŸ¥å®ƒæœ‰æ²’æœ‰åšä»»ä½•å¥‡æ€ªçš„äº‹ã€‚<a href="https://github.com/diafygi/acme-tiny/">acme-tiny</a> çš„ README ä¹Ÿæœ‰å€‹è¨­å®šæ•™å­¸ï¼Œæ‡‰è©²æ˜¯å¤§åŒå°ç•°ã€‚</p>
<p>åŸºæœ¬ä¸Šéƒ½æ˜¯ç…§è‘— <a href="https://robmclarty.com/blog/how-to-secure-your-web-app-using-https-with-letsencrypt"><em>How to Secure Your Web App Using HTTPS With Letsencrypt</em></a> è©²ç¯‡æ–‡ç« åšï¼Œä¸éæœ‰èª¿æ•´äº†ä»¥ä¸‹çš„æ±è¥¿ï¼š</p>
<ol>
<li>å»ºç«‹ letsencrypt å¸³è™Ÿæ™‚ï¼Œç¦æ­¢ä½¿ç”¨ password loginã€‚<br>
   å³ï¼š <code>adduser --disabled-password ...</code></li>
<li>ä½¿ç”¨ git ç®¡ç† <a href="https://github.com/diafygi/acme-tiny/">acme-tiny</a> scriptã€‚</li>
<li>æ”¹ç”¨ systemd æ§åˆ¶ nginxï¼Œè€Œä¸æ˜¯é€é serviceã€‚<br>
   å³ï¼š <code>systemctl reload nginx</code></li>
<li>æ²’æœ‰ç”¨ crontab è€Œæ˜¯ä½¿ç”¨ <a href="https://wiki.archlinux.org/index.php/Systemd/Timers">systemd Timers</a>ã€‚</li>
<li>é‡æ–°å°å¼• http é€£ç·šè‡³ httpsã€‚</li>
</ol>
<p>ç¬¬ 4ã€5 é»è¨­å®šæ¯”è¼ƒå¤šï¼Œæ•´ç†åˆ°å¾Œé¢ã€‚</p>
<h3 id="systemd-timer-certificate">è¨­å®š systemd timer å®šæ™‚æ›´æ–° certificate</h3>
<p>é€™é‚Šåƒè€ƒ <a href="http://www.certdepot.net/rhel7-use-systemd-timers/"><em>RHEL7: How to use Systemd timers.</em></a> ä¸€æ–‡ã€‚</p>
<p>Systemd Timer æ¦‚å¿µå¦‚åŒ crontabï¼Œä½†å·®åˆ¥æ˜¯ä½¿ç”¨ timer å³èˆ‡ systemd æ•´åˆã€‚<code>&lt;unit&gt;.timer</code> å¯ä»¥å®šæœŸåŸ·è¡Œ <code>&lt;unit&gt;.service</code>ï¼Œæ‰€ä»¥ <unit> åŸ·è¡Œçš„çµæœèˆ‡ç‹€æ…‹éƒ½èƒ½é¡¯ç¤ºåœ¨ systemd ä¸­ï¼Œä¹Ÿå¸¶å…¥äº† journald æœ‰çš„ logging åŠŸèƒ½ã€‚</p>
<p>æ›´æ–° certificate çš„æŒ‡ä»¤å¯«åœ¨ <code>/etc/letsencrypt/renew_cert.sh</code>ã€‚Shell script çš„å…§å®¹èˆ‡åƒè€ƒæ–‡ç« ä¸€æ¨£ã€‚</p>
<h4 id="systemd-service">Systemd service</h4>
<p>é¦–å…ˆå»ºç«‹ä¸€å€‹ renew_certï¼Œä»¥ Debian ç‚ºä¾‹æ”¾åœ¨ <code>/etc/systemd/system/renew_cert.service</code>ï¼Œ</p>
<div class="highlight"><pre><span></span><code class="language-ini"><span class="k">[Unit]</span><span class="w"></span>
<span class="na">Description</span><span class="o">=</span><span class="s">Renew Let&#39;s Encrypt cert</span><span class="w"></span>
<span class="na">After</span><span class="o">=</span><span class="s">syslog.target</span><span class="w"></span>

<span class="k">[Service]</span><span class="w"></span>
<span class="na">User</span><span class="o">=</span><span class="s">letsencrypt</span><span class="w"></span>
<span class="na">Group</span><span class="o">=</span><span class="s">letsencrypt</span><span class="w"></span>
<span class="na">ExecStart</span><span class="o">=</span><span class="s">/etc/letsencrypt/renew_cert.sh</span><span class="w"></span>
<span class="na">Type</span><span class="o">=</span><span class="s">simple</span><span class="w"></span>
<span class="na">StandardError</span><span class="o">=</span><span class="s">syslog</span><span class="w"></span>

<span class="k">[Install]</span><span class="w"></span>
<span class="na">WantedBy</span><span class="o">=</span><span class="s">multi-user.target</span><span class="w"></span>
</code></pre></div>

<p>è¦æ‰‹å‹•æ›´æ–° certificate çš„æ™‚å€™åŸ·è¡Œé€™å€‹ service å³å¯ï¼Œ</p>
<div class="highlight"><pre><span></span><code class="language-text">systemctl start renew_cert
</code></pre></div>

<p>æˆ‘å€‘ä¸éœ€è¦ enable å®ƒï¼Œä¸ç„¶æ¯æ¬¡é–‹æ©Ÿéƒ½æœƒåŸ·è¡Œä¸€æ¬¡ã€‚çœ‹çµæœæˆ–è¨˜éŒ„ï¼Œ</p>
<div class="highlight"><pre><span></span><code class="language-text">systemctl status renew_cert
journalctl -e -u renew_cert
</code></pre></div>

<h4 id="systemd-timer">Systemd Timer</h4>
<p>å»ºç«‹ä¸€å€‹ <code>/etc/systemd/system/renew_cert.timer</code></p>
<div class="highlight"><pre><span></span><code class="language-ini"><span class="k">[Unit]</span><span class="w"></span>
<span class="na">Description</span><span class="o">=</span><span class="s">Update Let&#39;s Encrypt certificate every two months</span><span class="w"></span>

<span class="k">[Timer]</span><span class="w"></span>
<span class="na">OnCalendar</span><span class="o">=</span><span class="s">*-1/2-1 16:00:00</span><span class="w"></span>
<span class="na">Unit</span><span class="o">=</span><span class="s">renew_cert.service</span><span class="w"></span>

<span class="k">[Install]</span><span class="w"></span>
<span class="na">WantedBy</span><span class="o">=</span><span class="s">multi-user.target</span><span class="w"></span>
</code></pre></div>

<p>é‡é»åªæœ‰ <code>[Timer]</code> é€™ directiveã€‚<code>Unit=</code> è¡¨ç¤ºè¦å•Ÿå‹•çš„ serviceã€‚<code>OnCalendar=</code><sup id="fnref:calendar"><a class="footnote-ref" href="#fn:calendar">1</a></sup> å‰‡æ˜¯è¨­å®šé€™ timer æ ¹æ“šæŒ‡å®šçš„æ™‚é–“é» (UTC æ™‚é–“<sup id="fnref:utc"><a class="footnote-ref" href="#fn:utc">2</a></sup>) å•Ÿå‹•ã€‚</p>
<p>ä»¥é€™é‚Šå¯«çš„æ™‚é–“ <code>*-1/2-1 16:00:00</code> ç‚ºä¾‹ï¼Œä»£è¡¨æ¯å¹´çš„ 1+2n æœˆ 1 æ—¥ 16:00 UTC æ›´æ–° certificateï¼Œå³è‡ºç£æ™‚é–“ 1ã€3ã€5ã€â€¦â€¦æœˆ 2 æ—¥å‡Œæ™¨æ›´æ–°ã€‚</p>
<p>å•Ÿç”¨ timerï¼Œå®ƒéœ€è¦è¢« enable ç¢ºä¿é‡é–‹æ©Ÿæ™‚è¢«åŸ·è¡Œã€‚</p>
<div class="highlight"><pre><span></span><code class="language-text">systemctl enable renew_cert.timer
systemctl start renew_cert.timer
</code></pre></div>

<p>å¯ä»¥ç”¨ <code>systemctl list-timers</code> æª¢æŸ¥å®ƒä¸‹æ¬¡åŸ·è¡Œçš„æ™‚é–“ï¼š</p>
<div class="highlight"><pre><span></span><code class="language-console"><span class="gp">$ </span>sudo systemctl list-timers renew_cert.timer
<span class="go">NEXT                         LEFT                LAST PASSED UNIT             ACTIVATES</span>
<span class="go">Tue 2016-03-01 16:00:00 UTC  1 weeks 2 days left n/a  n/a    renew_cert.timer renew_cert.service</span>
</code></pre></div>

<h3 id="nginx-http-redirect-to-https">nginx HTTP redirect to HTTPS</h3>
<p>ï¼ˆé€™é‚Šè¨­å®šæˆ‘æ²’ä¿¡å¿ƒï¼Œæœ‰æ›´å¥½çš„è¨­å®šæ–¹æ³•æ­¡è¿å‘Šè¨´æˆ‘ &gt; &lt;ï¼‰</p>
<p>è¦è§£æ±ºçš„å•é¡Œç‚ºï¼ŒACME challenge æ˜¯é€é HTTPï¼Œå…¶é¤˜çš„é€£ç·šéƒ½è½‰åˆ° HTTPSã€‚</p>
<p>åœ¨ nginx ä¸­æŠŠä¸»è¦çš„è¨­å®šæª”ä¸­æ‹¿æ‰ <code>listen 80;</code> èˆ‡ ACM challenge çš„éƒ¨ä»½ã€‚æŠŠå®ƒå€‘ç§»æˆæ–°çš„ server blockï¼š</p>
<div class="highlight"><pre><span></span><code class="language-nginx"><span class="k">server</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">docs.python.org.tw</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1"># For Let&#39;s Encrypt ACME challenge files</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/.well-known/acme-challenge/</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/var/www/challenges/</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="p">=</span><span class="mi">404</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kn">return</span><span class="w"> </span><span class="mi">301</span><span class="w"> </span><span class="s">https://</span><span class="nv">$host$request_uri</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<h3 id="https">æ¸¬è©¦ HTTPS è¨­å®š</h3>
<p>ç”¨äº† <a href="https://securityheaders.io/">securityheaders.io</a> å’Œ <a href="https://www.ssllabs.com/index.html">SSL Labs</a> æ¸¬è©¦äº†ä¸€ä¸‹ï¼Œæ‡‰è©²é‚„å¯ä»¥ï¼š</p>
<figure>
  <img src="https://blog.liang2.tw/posts/2016/02/pydoctw-https/pics/pydoctw_securityheaders_report.png"/>
  <p class="caption center">Report from securityheaders.io (<a href="https://securityheaders.io/?q=https%3A%2F%2Fdocs.python.org.tw%2F3%2F">Live Report</a>)</p>
</figure>

<figure>
  <img src="https://blog.liang2.tw/posts/2016/02/pydoctw-https/pics/pydoctw_ssllabs_report.png"/>
  <p class="caption center">Report from SSL Labs (<a href="https://www.ssllabs.com/ssltest/analyze.html?d=docs.python.org.tw">Live Report</a>)</p>
</figure>

<h3 id="_2">å¿ƒå¾—</h3>
<p>ç¸½çµä¾†èªªï¼Œä½¿ç”¨ <a href="https://letsencrypt.org/">Let&rsquo;s Encrypt</a> ä¸é›£ï¼Œä½†ä¹Ÿæ²’åˆ°éå¸¸ç°¡å–®ã€‚</p>
<p>å¦‚æœä½ é¡˜æ„æŠŠ root å’Œ private key æ¬Šé™çµ¦å®ƒçš„è©±ï¼Œç”¨å®˜æ–¹ client æä¾›çš„ <code>letsencrypt-auto</code> æ­¥é©Ÿèƒ½æ›´å°‘ï¼Œç”¨ Apache å®ƒè²ç¨±èƒ½å…¨è‡ªå‹•è¨­å®šã€‚è¦ºå¾— <a href="https://github.com/diafygi/acme-tiny/">acme-tiny</a> æŒ‡ä»¤å¤ªè¤‡é›œçš„è©±ï¼ŒåŸä½œè€…ä¹Ÿå¯«äº†ä¸€å€‹ <a href="https://gethttpsforfree.com/">Get HTTPS for free!</a> æœå‹™ï¼Œç”¨ç¶²é çš„æ–¹å¼å”åŠ©æ•´å€‹è¨»å†Šæµç¨‹ã€‚</p>
<p>è¦æ³¨æ„ç›®å‰ public beta éšæ®µï¼Œç›¸åŒ domain åœ¨ 7 å¤©åªèƒ½è¢«ç°½ç½² 5 æ¬¡ï¼Œæ¸¬è©¦çš„æ™‚å€™ä¸è¦å¤ªè¡å‹•ä¸ç„¶å°±è¦ç­‰ä¸€é€±äº†ã€‚</p>
<h3 id="misc">Misc.</h3>
<p>å»ºç«‹ CSR (Certificate Signing Request) æª”æ™‚ï¼Œå¯ä»¥åŠ å…¥è‡ªå·±çš„ email åœ°å€ï¼Œä¸ç„¶é è¨­æ˜¯ <code>webmaster@&lt;domain&gt;</code>ï¼š</p>
<div class="highlight"><pre><span></span><code class="language-bash">openssl req -new -sha256 <span class="se">\</span>
    -key /etc/letsencrypt/private/domain.key <span class="se">\</span>
    -subj <span class="s2">&quot;/CN=docs.python.org.tw/emailAddress=me+pydoctw@liang2.tw&quot;</span> <span class="se">\</span>
    &gt; /etc/letsencrypt/private/domain.csr
</code></pre></div>

<div class="footnote">
<hr>
<ol>
<li id="fn:calendar">
<p>é™¤äº† <code>OnCalendar</code> é‚„æœ‰å¾ˆå¤šè¨­å®š timer çš„æ–¹å¼ï¼Œå¦‚ <code>OnUnitActiveSec</code>ã€‚ä¸éå…¶ä»–çš„æ™‚é–“ç®—æ³•ï¼Œéƒ½æœƒå—æœ‰æ²’æœ‰é–‹æ©Ÿï¼Œå½±éŸ¿æ™‚é–“çš„è¨ˆç®—ã€‚&#160;<a class="footnote-backref" href="#fnref:calendar" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:utc">
<p>Debian Jessie çš„ <a href="https://www.freedesktop.org/software/systemd/man/systemd.time.html#Calendar%20Events">systemd.time (7)</a> Calendar Events è£¡ä¸¦æ²’æœ‰æŒ‡å®šæ™‚å€çš„æ–¹å¼ï¼Œæ‰€ä»¥åŠ ä¸Šæ™‚å€æœƒæœ‰ parse errorã€‚ä½†æ–°ç‰ˆçš„ systemd ä¼¼ä¹æ”¯æ´æ™‚å€ã€‚ç¸½ä¹‹æ‡‰è©²ç”¨ <code>systemctl list-timers</code> ç¢ºå®šåŸ·è¡Œçš„æ™‚é–“ã€‚&#160;<a class="footnote-backref" href="#fnref:utc" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div></section>
    <footer class="post-footer">
	<section
		class="utterances"
		data-repo="ccwang002/ccwang002.github.io"
		data-issue-term="pathname"
		data-label="Comment">
	</section>
	</footer>
</article>
	</main>
	<footer class="site-footer">
		<button class="subscribe"
			href="https://blog.liang2.tw/feeds/all.atom.xml"
			aria-label="Subscribe the Atom feed"
			data-tooltip="Subscribe"
		>
			<svg viewBox="0 0 24 24" width="24" height="24">
				<title>Atom feed</title>
				<circle cx="6.18" cy="17.82" r="2.18"/>
				<path d="m4 10.1v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9zm0-5.66v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56z"/>
			</svg>
		</button>
		<div class="inner">
			<section>
				Browse articles by
				<a href="https://blog.liang2.tw/tags.html">Tags</a> |
				<a href="https://blog.liang2.tw/categories.html">Categories</a>
			</section>
			<section class="contact">
				Contact me by
				<a href="https://twitter.com/lbwang2">Twitter</a> |
				<a href="https://www.facebook.com/lbwang.2">Facebook</a> |
				<a href="https://github.com/ccwang002">GitHub</a> |
				<a href="mailto:me+blog@liang2.tw">Email</a> |
				<a href="https://www.linkedin.com/in/liangbowang/">LinkedIn</a>
			</section>
			<section class="copyright">
				This work is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
			</section>
			<section class="powered-by">
				Built using <a href="https://getpelican.com/">Pelican</a>.
				Powered by the <a href="https://github.com/kura/hauntr">Hauntr</a> theme.
			</section>
		</div>
	</footer>
	<script src="https://blog.liang2.tw/theme/scripts/color_scheme.js"></script>
</body>
</html>