<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Liang-Bo Wang's Blog - font</title><link href="https://blog.liang2.tw/" rel="alternate"></link><link href="https://blog.liang2.tw/feeds/tag_font.atom.xml" rel="self"></link><id>https://blog.liang2.tw/</id><updated>2022-05-13T12:50:28-05:00</updated><entry><title>Fix Fira Code font ligatures and features</title><link href="https://blog.liang2.tw/posts/2022/03/fix-fira-code-font-features/" rel="alternate"></link><published>2022-03-01T00:00:00-06:00</published><updated>2022-05-13T12:50:28-05:00</updated><author><name>Liang-Bo Wang</name></author><id>tag:blog.liang2.tw,2022-03-01:/posts/2022/03/fix-fira-code-font-features/</id><summary type="html">&lt;p&gt;&lt;a href="https://github.com/tonsky/FiraCode"&gt;Fira Code&lt;/a&gt; has been my choice of the programming font for a while. It&amp;rsquo;s also the default monospace font of my blog.
I like its ligatures such as &lt;code&gt;&amp;gt;=&lt;/code&gt; and connected lines &lt;code&gt;======&lt;/code&gt; &lt;code&gt;------&lt;/code&gt;.
It evens renders the progress bar nicely &lt;code&gt;&lt;/code&gt;.
It makes my plain text documents look neat.&lt;/p&gt;
&lt;p&gt;That said, I …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="https://github.com/tonsky/FiraCode"&gt;Fira Code&lt;/a&gt; has been my choice of the programming font for a while. It&amp;rsquo;s also the default monospace font of my blog.
I like its ligatures such as &lt;code&gt;&amp;gt;=&lt;/code&gt; and connected lines &lt;code&gt;======&lt;/code&gt; &lt;code&gt;------&lt;/code&gt;.
It evens renders the progress bar nicely &lt;code&gt;&lt;/code&gt;.
It makes my plain text documents look neat.&lt;/p&gt;
&lt;p&gt;That said, I don&amp;rsquo;t like the default ampersands &lt;code&gt;&amp;amp;&lt;/code&gt; and the at signs &lt;code&gt;@&lt;/code&gt;.
I find them harder to read than their traditional looks.
To change their looks, we can enable the alternative ligatures and features of the font using &lt;a href="https://ilovetypography.com/OpenType/opentype-features.html"&gt;different OpenType features&lt;/a&gt; (see also &lt;a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Fonts/OpenType_fonts_guide"&gt;the guide on MDN&lt;/a&gt;).
In this case, &lt;code&gt;ss05&lt;/code&gt; and &lt;code&gt;ss08&lt;/code&gt; enable the traditional looks of ampersands and at signs, respectively.
Most modern editors and word processors are able to configure the feature sets in use.&lt;/p&gt;
&lt;figure&gt;
    &lt;img src="https://blog.liang2.tw/posts/2022/03/fix-fira-code-font-features/pics/fira_code_comparison.png"&gt;
    &lt;figcaption&gt;Comparison of the Fira Code rendering with and without the features fixed (ss01, ss03, ss05, and ss08).&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Unfortunately, I encounter programs that are unable to configure the font features.
While tools like &lt;a href="https://twardoch.github.io/fonttools-opentype-feature-freezer/"&gt;pyftfeatfreeze (OpenType Feature Freezer)&lt;/a&gt; are able to swap specific glyphs by directly editing the font file, ligatures of those glyphs may fail.
For example, &lt;code&gt;ss08&lt;/code&gt; feature (e.g., &lt;code&gt;==&lt;/code&gt;, &lt;code&gt;!=&lt;/code&gt;, and &lt;code&gt;===&lt;/code&gt;) won&amp;rsquo;t be permanently enabled using this approach.&lt;/p&gt;
&lt;h2 id="permanently-fix-the-font-features-using-the-official-build-script-update-in-2022-03"&gt;Permanently fix the font features using the official build script (update in 2022-03)&lt;/h2&gt;
&lt;p&gt;Thanks to the &lt;a href="https://github.com/tonsky/FiraCode/pull/1387"&gt;pull request by &lt;code&gt;@Daxtorim&lt;/code&gt;&lt;/a&gt; a few days after this post was published, we now are able to permanently fix the font features using the official build script:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;docker run -it --rm &lt;span class="se"&gt;\&lt;/span&gt;
    -v &lt;span class="nv"&gt;$PWD&lt;/span&gt;:/opt/FiraCode &lt;span class="se"&gt;\&lt;/span&gt;
    tonsky/firacode:latest &lt;span class="se"&gt;\&lt;/span&gt;
    ./FiraCode/script/build.sh &lt;span class="se"&gt;\&lt;/span&gt;
    -f &lt;span class="s2"&gt;&amp;quot;ss01,ss03,ss05,ss08&amp;quot;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
    -n &lt;span class="s2"&gt;&amp;quot;Fira Code ss01 ss03 ss05 ss08&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# Rename the generated TTFs&lt;/span&gt;
parallel &lt;span class="s1"&gt;&amp;#39;mv {} {.}.ss1358_enabled.ttf&amp;#39;&lt;/span&gt; ::: distr/ttf/&lt;span class="s1"&gt;&amp;#39;Fira Code ss01 ss03 ss05 ss08&amp;#39;&lt;/span&gt;/*.ttf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And that&amp;rsquo;s it!
This is the easiest solution and it works straight out of the box.
Praise the open source community :)
I still kept the original instructions below to manually create the patches since that&amp;rsquo;s what happens behind the scene.&lt;/p&gt;
&lt;h2 id="permanently-fix-the-font-features"&gt;Permanently fix the font features&lt;/h2&gt;
&lt;p&gt;By changing the source code of the font generation, it should be possible to permanently fix any font features (aka patching).
As mentioned by &lt;a href="https://github.com/tonsky/FiraCode/issues/869#issuecomment-548006778"&gt;the original author (&lt;code&gt;@tonsky&lt;/code&gt;)&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There is probably a simpler approach to patching the font, just concat whatever code there is in ssXX and add it to the end of calt feature.
That should work on the current version of the font, but you’ll need to do your own research on which scripts to use for that&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;And that&amp;rsquo;s exactly my patch for &lt;code&gt;FiraCode.glyphs&lt;/code&gt;.
Copy all the content of the features (say, ss01, ss03, ss05, and ss08) to &lt;code&gt;calt&lt;/code&gt;. So the original code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;# FiraCode.glyphs
{
code = &amp;quot;lookup less_bar_greater ...
... underscores;\012&amp;quot;;
name = calt;
},
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;becomes:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;{
code = &amp;quot;lookup less_bar_greater ...
... underscores;\012
# ss01\012  sub r by r.ss01;
# ss03\012  sub ampersand by ampersand.ss03;...
# ss05\012  sub at by at.ss05;\012sub asciitilde.spacer&amp;#39;; ...
# ss08\012  sub equal_equal.liga by equal_equal.ss08;...
&amp;quot;;
name = calt;
},
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then build the font from the &lt;code&gt;.glyphs&lt;/code&gt; file using the Docker image:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;docker run -it --rm &lt;span class="se"&gt;\&lt;/span&gt;
    -v &lt;span class="nv"&gt;$PWD&lt;/span&gt;:/opt/FiraCode &lt;span class="se"&gt;\&lt;/span&gt;
    tonsky/firacode ./FiraCode/script/build.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To set a different font name for the feature fixed fonts, I use &lt;a href="https://twardoch.github.io/fonttools-opentype-feature-freezer/"&gt;pyftfeatfreeze&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;parallel &lt;span class="se"&gt;\&lt;/span&gt;
    pyftfeatfreeze &lt;span class="se"&gt;\&lt;/span&gt;
        --suffix --usesuffix&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;#39;ss01 ss03 ss05 ss08&amp;#39;&amp;quot;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
        -v -n &lt;span class="se"&gt;\&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;{}&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;features_enabled/{/.}.ss1358_enabled.ttf&amp;#39;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
        ::: ttf/*.ttf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Coding"></category><category term="en"></category><category term="font"></category></entry></feed>